---
title: 量测和输出系统
description: 介绍 EMTLab 的量测和输出系统
sidebar_position: 30

tags: 
- EMTLab
---

:::warning
1. 这篇文档问题很大！前面介绍信号类型的部分不通顺，介绍控制量量测时，为何还要介绍虚拟输入？？？？？这有关系么 (7月底前完成)
2. 虚拟输出引脚的描述要修改。现在不需要#号了。（7月底前完成）
3. 多维信号量测不要放在FAQ部分，放在前面重点介绍。（7月底前完成）
4. 这篇文档的逻辑重新组织一下：
   1. 第一部分 - 信号量测：先介绍信号的种类，再介绍不同种类的量测方法；介绍输出通道元件，强调一下信号维度、信号名称两个概念。告知用户如何辨识量测出来的信号维度是多少？如何提取多维信号中的一路或几路？（直接引用挑战跳转多路信号合并、多路信号分离两个元件的用法）（7月底前完成）
   2. 第二部分 - 配置示波器输出通道：介绍输出通道配置方法，包括示波器分组、采样频率、窗口类型、窗口宽度、示波器输出通道几个概念的介绍和配置方法。
   3. 第三部分 - 仿真结果编辑：包括对示波器窗口的各类操作、结果保存等操作。
   4. 在示波器输出通道那里备注好：该功能仅在离线仿真中生效。实时仿真的通道配置参考XXX页面。
5. 注意按照规范要求调整该文档。(优先级低)
:::


本文档介绍 EMTLab 的量测和输出系统，包括信号的量测方法、输出窗口（示波器）的设置、结果保存等功能。

## 功能定义
EMTLab 提供的针对电气、控制信号的统一量测方法和波形曲线输出系统。

## 功能说明
在电磁暂态仿真中，如果用户想要观察某一信号随时间变化的过程，需要将该信号（量测信号）连接到输出通道，并在计算方案中设置输出通道，则在仿真结果的示波器窗口中可显示该量测信号。

### 量测方法

#### 量测信号与输出通道
EMTLab 中的信号类型分为**电气量**和**控制量**两类，**电气量**包括电流、电压、功率、电气元件的内部量等，**控制量**为控制元件的输入量和输出量等。  

量测信号有信号维数的区别，比如阶跃信号发生器的输出信号为 1 维信号，三相交流母线上的瞬时电压为 3 维信号。因此，输出通道的维数需要与量测信号的维数相匹配。输出通道另一参数为通道名称，用于命名波形，即示波器窗口波形的图例名。

![输出通道参数 =x400](./output-channel.png)

#### 电气量量测方法
对于电气量的量测主要有三种方法：
- 对于电气节点，可以直接测量其电压信号（单位为 V），将**输出通道**和电气节点直接相连即可。
- 利用量测元件(如电压表、电流表、功率表等)测信号名称(以 `#` 号开头)或量测信号输出引脚。

![采用电流表测量电流 =x150](./measure-1.png)

- 利用元件的 `Monitoring` 参数组中的参数填写输出量测信号名称(以 `#` 号开头)。

![采用内部量输出得到电压测量信号 =x200](./monitoring.png)

#### 控制量量测方法
控制量的量测与电气量基本相同，主要有两种量测方法：
- 对于控制元件，可以直接量测其控制信号，将**输出通道**和控制元件引脚直接相连即可。
- 对于虚拟输入引脚型参数，即**动态参数**（以 `@` 号开头），将动态参数填入输出通道引脚。

![量测积分器的动态限幅参数 =x200](./dynamic-paramter.png)

:::info
SimStudio v4.3 之前的版本，虚拟输出引脚的信号标签必须是以`#`标签开头的字符串，如`#I_R`、`#Ps`等。**v4.3及之后的版本移除了上述限制，虚拟引脚与一般引脚的用法一致**。

用户使用前，请先点击 SimStudio 左侧标签栏最下方的 **设置** 按钮，点击 **关于** 选项查看当前的版本号，并参考对应版本的命名标准。
:::


### 信号输出
为实现对某一信号的输出显示，必须完成以下配置：
- 将需要输出的信号与一个输出通道相连（注意输出通道的维数与量测信号相匹配）。
- 将待输出的通道列入仿真的计算方案中。
  - 在**运行**标签页下，选中电磁暂态方案，点击**基本设置 - 输出通道**选项，可弹出**输出通道**的可编辑表格。在该表格中可添加**输出窗口**，并将需要输出的**输出通道**添加到**示波器输出通道**栏中，如下图所示。

![电磁暂态方案中的输出通道设置 =x250](./out1.png)

![示波器输出通道选择](./out2.png)

输出通道的相关设置参数说明如下表。

| 名称 | 说明 |
| :--- | :--- | 
| 示波器分组名称 | 该名称用作结果页面中的图表标题 |
| 采样频率 | 示波器的采样频率，采样频率越高，单位时间的采样点越多；采样频率最大不超过 1 / 仿真积分步长 |
| 窗口类型 | 示波器窗口类型，具体说明可见 [输出窗口类型](./index.md#输出窗口类型) |
| 窗口宽度 | 窗口类型为 `Moving Time Axis Window` 或 `Oscilloscope Time Axis Window` 时的时间坐标轴范围 |

在一个仿真项目中，**输出通道**和**输出窗口**理论上可存在任意个，用户可根据待输出信号的类型、大小范围等合理设置**输出窗口**所选中的通道信号，便于仿真结果分析。

#### 输出窗口类型
EMTLab 提供了四种示波器窗口类型，用户可选择每个示波器的显示模式，如下图所示。

一共有四种模式可选，其含义分别如下：

1. `Compressed Time Axis Window`：默认模式，时间坐标轴最大值随仿真时间变化，最小值为仿真开始时间不变，如下图所示。

![Compressed Time Axis Window模式演示](./compressed-time-axis-window.gif)

2. `Global Time Axis Window`：时间坐标轴最大值为仿真结束时间不变，最小值为仿真开始时间不变，如下图所示。

![Global Time Axis Window模式演示](./global-time-axis-window.gif)

3. `Moving Time Axis Window`：时间坐标轴最大值随仿真时间变化，时间坐标轴范围为参数 `Window Width` 指示的值，如下图所示。

![Moving Time Axis Window模式演示](./moving-time-axis-window.gif)

4. `Oscilloscope Time Axis Window`：与示波器显示模式相近，仿真窗口时间轴范围为 `Window Width` 指示的值，如下图所示。

![Oscilloscope Time Axis Window模式演示](./oscilloscope-time-axis-window.gif)

### 结果保存
完成信号输出的操作，在仿真结束后，可以在**运行标签页**的**结果**处查看到各输出窗口的结果。输出窗口的上侧为图表标题，左侧和下侧分别为图表的 x 轴标题和 y 轴标题，右侧为图例。

![输出窗口 =x350](./output-window.png)

鼠标放在输出窗口上时，可在右上角显示输出窗口的操作按钮，具体说明如下表。

| 操作按钮名 | 说明 |
| :--- | :--- | 
| 缩放 | 鼠标框选缩放波形 |
| 平移 | 鼠标拖动波形平移 |
| 放大 | 放大当前图形 |
| 缩小| 缩小当前图形 |
| 自动缩放 | 显示默认大小波形 |
| 重置轴 | 重置 `X/Y` 轴 |
| 悬停时比较数据 | 鼠标悬停显示 X, Y 轴对应辅助线 |
| 悬停时显示最近的数据 | 鼠标悬停显示最近数据 |
| 下载图表为 CSV 格式 | 将当前输出窗口中所有通道数据导出到 `.CSV` 文件中 |
| 下载图表为 PNG 格式 | 将当前输出窗口图形保存为 `.png` 文件 |
| 在 `chart studio` 中编辑 | 在 `chart studio` 中编辑当前输出窗口的图表 |

如需保存窗口内的信号数据，可点击**下载图表为 CSV 格式**，导出的 CSV 数据格式如下，第一列为图表的 x 轴，即仿真时间，第二列为图表的 y 轴，即该仿真时间点的信号值。

![CSV格式](./csv-format.png)

## 案例
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs>
<TabItem value="case1" label="3 机 9 节点算例的量测和输出系统设置">
本案例使用 IEEE 9 节点模板算例，演示量测方法以及输出系统的设置与使用。

- 在 SimStudio 工作台，点击新建电力系统仿真项目。  

![新建电力系统仿真项目 =x190](./new-project.png)

- 点击左上角的新建图标，选中 IEEE 标准系统，选择 3 机 9 节点标准测试系统，点击新建。
  
![新建 IEEE9 节点算例 =x500](./new-case.png)

- 模板中使用了两种量测方法，分别是通过量测元件（电压表）获取量测信号，和通过元件内部量测获取量测信号。

![通过电压表量测7号母线电压 =x250](./measure-1-1.png)

![通过内部量获取同步电机量测信号 =x400](./measure-2-1.png) 

- 在**实现标签页**，拖拽输出通道元件，将维数设置为 3 维，将输出通道与 1 号母线相连，测量1号母线电压信号。

![直接量测电气信号 =x350](./measure-3.png)

- 在**运行**标签页，设置输出通道，将新增加的输出通道添加到输出窗口。

![设置输出通道 =x300](set-output-channel-1.png) 

![增加输出窗口 =x100](set-output-channel-2.png)

- 点击仿真按钮，在结果界面，可以查看到 1 号母线三相电压，选中 3 秒附近区域，可查看接地故障时 1 号母线三相电压波形。

![1 号母线三相电压 =x300](./result.png)

![接地故障时 1 号母线电压 =x300](./result-1.png) 

</TabItem>
</Tabs>


## 常见问题 Q&A
假如有两个相似的算例，量测的信号相同，如何快速设置输出通道。

:
  用户可以在一个算例设置好输出通道后，使用输出通道导出功能，将输出通道导出为 CSV 格式，然后在另一个算例中导入该 CSV 文件，即可快速获取到相同的输出通道。

  ![导入或导出输出通道 =x300](./import-or-export-output-channels.png)

如何量测多维信号的其中一维

:
  某些元件的量测信号为多维信号，例如三相交流电压源元件 `Monitoring` 参数组中的 `3 Phase Source Votage Vector` 所对应的信号即为三维信号。用户若需要其中某一维的信号，如 A 相，则可利用多路信号分离元件进行信号拆分。同理，若要将多路信号合并为多维信号进行量测，则可利用多路信号合并元件进行信号合并。

  ![信号分离与信号合并 =x150](./signal-finishing.png)
