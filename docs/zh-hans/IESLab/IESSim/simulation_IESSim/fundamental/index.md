---
title: 综合能源仿真计算原理
order: 100
---

## 稳态能量流计算

类比于电力系统中的潮流，冷热系统中也有热力潮流，平台的综合能源**能量潮流**则包含电力潮流和热力潮流。平台主要对综合能源系统能量流动的**稳态**进行仿真计算。

综合能源系统的仿真计算则主要有两种方法：`独立求解和联立求解`；独立求解首先通过`分解算法`将系统分为不同能源字系统，然后各能源子系统独立求解，在耦合设备处通过协调算法迭代达到整个系统的收敛；联立统一求解则一般通过Newton-Raphson法`统一迭代`求解。 一般而言，独立求解计算的效率速度更优，鲁棒性更好；联立统一迭代则更依赖于系统初值，更容易不收敛。

## 电力系统潮流计算

电力系统潮流计算是研究电力系统`稳态运行`情况的一种基本电气计算，是电力系统规划、运行、调度与控制的基础。它的任务是根据`给定的运行条件和网络结构`确定整个系统的运行状态，主要是各节点电压幅值和相角、网络中功率分布及功率损耗。它的计算结果是电力系统`稳定计算`和`故障分析`的必要条件，是对电力系统规划设计和运行方式的合理性、可靠性及经济性进行定量分析的重要依据。


输电网的潮流算法历史悠久，`牛顿法`及其衍生的`快速分解法`已经成为标准算法。这些算法已经成功地运用在环状结构的输电网络中。对于大规模系统，为了减少计算工作量，对于输电系统做了一定的假设：
（1）输电网络中元件电抗远大于电阻，以致节点电压相位角的改变主要影响节点的注入有功功率；节电电压大小的改变主要影响节点的注入无功功率。这样可以将修正方程中的有功和无功功率方程解耦； 
（2）认为两个节点之间的电压相角相差不大，从而使雅克比矩阵在计算中恒定不变；
通过以上假设形成了著名的` PQ 分解法`。但是利用牛顿－拉夫逊算法和 PQ 分解法进行配电网络潮流计算时却遇到了困难：
（1）线路电阻和电抗相差不大，无法将有功和无功方程解耦；
（2）网络规模庞大，利用牛顿－拉夫逊算法效率很低。
因此，计算配电网潮流时很少直接采用牛顿－拉夫逊算法或 PQ 分解法。


对于配电网的潮流计算，可以分为`前推回代法、BUSZ 高斯法、直接法、改进牛顿法、网络化简法`等。但在含有分布式发电的配电网中，传统的前推回代等以传统辐射状配电网为基础的算法不再适用。

在大量新能源分布式接入电网的情况下，形成了复杂的电网潮流变化，传统的配电网逐渐像**新型配电系统**转变升级。对于新型配电系统潮流计算，主要有`牛顿法`、`隐Zbus法`和`同伦法`等算法。

## 热力系统能量流计算

冷热系统是一个`水热力耦合`的复杂模型，包含`水力过程`和`热力过程`，水力过程主要是求解`流体的输运过程`，包含`质量守恒`方程（连续方程）和`压力方程`（运动方程，为热网中流体循环运动的方程），对供热系统中的节点压力和质量流量进行计算。热力计算主要是求解流体的`能量方程`，对流体`温度`进行求解。

水热力方程是`强非线性方程`，其求解较为复杂。对于暂态过程的非稳态精细化仿真主要采用CFD方法，主要对纳维-斯托克斯方程（Navier-Stokes equations）进行求解。平台为`稳态能量流`计算，其求解可采用非线性方程求解方法。可利用`Newton-Raphson`法迭代求解，但牛顿法依赖于系统初值，容易不收敛，可能导致整个综合能源系统无法求解；也可以将水热力方程`线性简化`，但计算精度低。

一般而言，管网运动主要由水力方程决定，水力方程会影响热力计算，但热力方程一般不会影响水力循环，因此平台将水力方程和热力方程`解耦`，先求解水力方程，水力方程求解后，流体质量流量变为已知，带入热力方程通常使得热力方程线性化，很容易求解。

