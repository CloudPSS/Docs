<!-- BEGIN header -->
<%_
  const sidebar = page.sidebar !== false;
-%>
<header class="<%- !sidebar ? 'no-sidebar' : ''%>">
  <a class="button" id="sidebar"></a>
  <a class="button" id="nav"></a>
  <a id="logo" href="<%- config.base_url %>" title="<%- config.title %>"></a>
  <nav>
    <form id="search" title="<%- __('search.title') %>" @submit.prevent="submit" :class="{open: suggestOpen}">
      <input type="search" id="query" @focus="showSuggest" @blur="hideSuggest" v-model="term" />
      <label for="query"></label>
      <ul id="suggest">
        <span>
          {{  failed ? '<%- __('search.failed') %>'
            : succeed && term.trim() === '' ? '<%- __('search.prompt') %>'
            : succeed && matches.length === 0 && term.trim() !== '' ? '<%- __('search.no-result') %>'
            : !succeed && !failed ? '<%- __('search.loading') %>'
            : ''}}
        </span>
        <li v-for="record in matches" :key="record.url" :title="record.title"> 
          <a :href="record.url" @focus="showSuggest" @blur="hideSuggest">
            <span role="title">{{record.title}}</span>
            <span role="category" v-if="record.type">{{sitemap[record.type].name[lang]}}</span>
          </a>
        </li>
      </ul>
    </form>
    <%- js('js/search') -%>
    <ul>
      <%_ 
        for (const key in site.data.sitemap) { 
          -%><li><%- link_to(url_for(`${page.lang}/${key}/`), site.data.sitemap[key].name[page.lang], {class: `nav-link ${page.type === key ? 'current' : ''}`}) %></li><%_ 
        } 
      -%>
      <li id="lang-select" title="<%- __('select-lang') %>">
        <select data-canonical="<%- page.path.substring(page.path.indexOf('/') + 1) %>" onchange="location.href = `<%-config.root%>${this.value}/${this.dataset.canonical}`">
        <%_ 
          for (const key in site.data.i18n) { 
            -%><option value="<%-key%>" <%- key === page.lang ? 'selected' : ''%>><%- site.data.i18n[key] %></option><%_ 
          } 
        -%>
        </select>
      </li>
    </ul>
  </nav>
</header>
<!-- END header -->